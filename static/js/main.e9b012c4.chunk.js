(this.webpackJsonpundefined=this.webpackJsonpundefined||[]).push([[0],{20:function(e,t,a){e.exports=a(33)},25:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),s=a(16),r=a.n(s),l=a(13);const c="https://reactnd-books-api.udacity.com";let h=localStorage.token;h||(h=localStorage.token=Math.random().toString(36).substr(-8));const i={Accept:"application/json",Authorization:h};var m=a(5),d=(a(25),a(6));class b extends o.Component{render(){const e=this.props,t=e.shelf,a=e.onShelfChange;return n.a.createElement("div",{className:"book-shelf-changer"},n.a.createElement("select",{value:t||"none",onChange:e=>a(e.target.value)},n.a.createElement("option",{value:"moveTo",disabled:!0},"Move to..."),n.a.createElement("option",{value:"currentlyReading"},"Currently Reading"),n.a.createElement("option",{value:"wantToRead"},"Want to Read"),n.a.createElement("option",{value:"read"},"Read"),n.a.createElement("option",{value:"none"},"None")))}}var u=b;class p extends o.Component{render(){const e=this.props,t=e.book,a=e.onShelfChange,o={width:128,height:193};return t.imageLinks&&t.imageLinks.thumbnail&&(o.backgroundImage="url(".concat(t.imageLinks.thumbnail,")")),n.a.createElement("div",{className:"book"},n.a.createElement("div",{className:"book-top"},n.a.createElement("div",{className:"book-cover",style:o}),n.a.createElement(u,{shelf:t.shelf,onShelfChange:e=>a(t,e)})),n.a.createElement("div",{className:"book-title"},t.title),t.authors&&n.a.createElement("div",{className:"book-authors"},t.authors.map(e=>n.a.createElement("p",{key:e},e))))}}var k=p;class f extends o.Component{render(){const e=this.props,t=e.books,a=e.onShelfChange;return n.a.createElement("ol",{className:"books-grid"},t.map(e=>n.a.createElement("li",{key:e.id},n.a.createElement(k,{book:e,onShelfChange:a}))))}}var E=f;class g extends o.Component{render(){const e=this.props,t=e.title,a=e.books,o=e.onShelfChange;return n.a.createElement("div",{className:"bookshelf"},n.a.createElement("h2",{className:"bookshelf-title"},t),n.a.createElement("div",{className:"bookshelf-books"},n.a.createElement(E,{books:a,onShelfChange:o})))}}var v=g;class S extends o.Component{render(){const e=this.props,t=e.books,a=e.onShelfChange,o=t.reduce((function(e,t){return e[t.shelf]=e[t.shelf]||[],e[t.shelf].push(t),e}),[]),s=o.currentlyReading,r=o.wantToRead,l=o.read;return n.a.createElement("div",{className:"list-books"},n.a.createElement("div",{className:"list-books-title"},n.a.createElement("h1",null,"MyReads")),n.a.createElement("div",{className:"list-books-content"},n.a.createElement("div",null,s&&n.a.createElement(v,{title:"Currently Reading",books:s,onShelfChange:a}),r&&n.a.createElement(v,{title:"Want to Read",books:r,onShelfChange:a}),l&&n.a.createElement(v,{title:"Read",books:l,onShelfChange:a}))),n.a.createElement("div",{className:"open-search"},n.a.createElement(d.b,{to:"/search"},"Add a book")))}}var C=S,y=a(19);class N extends o.Component{constructor(...e){super(...e),this.state={query:"",books:[]},this.updateQuery=e=>{this.setState({query:e}),e?this.props.onSearch(e).then(e=>{e&&(e.error?this.setState({books:[]}):this.setState({books:e}))}):this.setState({books:[]})}}render(){const e=this.props.onShelfChange,t=this.state.books.map(e=>{const t=this.props.booksInShelf.find(t=>t.id===e.id);return Object.assign({},t,e)});return n.a.createElement("div",{className:"search-books"},n.a.createElement("div",{className:"search-books-bar"},n.a.createElement(d.b,{className:"close-search",to:"/"},"Close"),n.a.createElement("div",{className:"search-books-input-wrapper"},n.a.createElement(y.DebounceInput,{type:"text",placeholder:"Search by title or author",debounceTimeout:300,onChange:e=>this.updateQuery(e.target.value)}))),n.a.createElement("div",{className:"search-books-results"},n.a.createElement(E,{books:t,onShelfChange:e})))}}var j=N;class x extends o.Component{constructor(...e){super(...e),this.state={books:[]},this.updateBookShelf=(e,t)=>{((e,t)=>fetch("".concat(c,"/books/").concat(e.id),{method:"PUT",headers:Object(l.a)({},i,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(e=>e.json()))(e,t).then(()=>{this.setState(a=>{const o=a.books.findIndex(t=>t.id===e.id);if(-1!==o)return{books:[...a.books.slice(0,o),Object.assign({},a.books[o],{shelf:t}),...a.books.slice(o+1)]};const n=a.books.slice();return n.push(Object.assign({},e,{shelf:t})),{books:n}})})},this.searchBooks=e=>(e=>fetch("".concat(c,"/search"),{method:"POST",headers:Object(l.a)({},i,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(e=>e.json()).then(e=>e.books))(e).then(e=>e)}componentDidMount(){fetch("".concat(c,"/books"),{headers:i}).then(e=>e.json()).then(e=>e.books).then(e=>{this.setState({books:e})})}render(){const e=this.state.books;return n.a.createElement("div",{className:"app"},n.a.createElement(m.a,{path:"/search",render:()=>n.a.createElement(j,{onSearch:this.searchBooks,booksInShelf:e,onShelfChange:this.updateBookShelf})}),n.a.createElement(m.a,{exact:!0,path:"/",render:()=>n.a.createElement(C,{books:e,onShelfChange:this.updateBookShelf})}))}}var R=x;a(32);r.a.render(n.a.createElement(d.a,null,n.a.createElement(R,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.e9b012c4.chunk.js.map